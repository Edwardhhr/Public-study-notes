# Windows常用配置命令

### 常用Win+R系统配置命令
#### 1. **`msconfig`**
- **功能**：用于修改和调节系统启动方式、状态、后台服务等。
- **使用场景**：
  - 查看和管理启动项。
  - 禁用不必要的启动程序以加快系统启动速度。
  - 管理系统服务的启动状态。
- **命令**：
  ```plaintext
  msconfig
  ```

#### 2. **`gpedit.msc`**
- **功能**：组策略编辑器，用于对计算机的安全、功能等设置用户自定义的策略。
- **使用场景**：
  - 在企业环境中配置统一的安全策略。
  - 管理用户权限和访问控制。
  - 配置网络、软件和系统设置。
- **命令**：
  ```plaintext
  gpedit.msc
  ```

#### 3. **`regedit`**
- **功能**：注册表编辑器，用于查看和修改 Windows 注册表。注册表存储了系统、软件、驱动程序和用户设置的信息。
- **使用场景**：
  - 修复软件或系统设置问题。
  - 调整系统性能或功能。
  - 管理用户权限和系统策略。
- **命令**：
  ```plaintext
  regedit
  ```

#### 4. **`services.msc`**
- **功能**：用于管理 Windows 系统中的服务，包括启动、停止、暂停或恢复服务。
- **使用场景**：
  - 管理后台运行的服务。
  - 优化系统性能，关闭不必要的服务。
  - 修复服务相关问题。
- **命令**：
  ```plaintext
  services.msc
  ```

#### 5. **`devmgmt.msc`**
- **功能**：设备管理器，用于管理计算机上的硬件设备，包括查看硬件状态、更新驱动程序、卸载设备等。
- **使用场景**：
  - 诊断和修复硬件设备问题。
  - 更新硬件驱动程序。
  - 管理硬件资源分配。
- **命令**：
  ```plaintext
  devmgmt.msc
  ```

#### 6. **`eventvwr.msc`**
- **功能**：事件查看器，用于查看系统日志、应用程序日志和安全日志，帮助分析系统问题的根源。
- **使用场景**：
  - 查找系统错误、警告和信息。
  - 分析系统性能问题。
  - 监控系统安全事件。
- **命令**：
  ```plaintext
  eventvwr.msc
  ```

#### 7. **`diskmgmt.msc`**
- **功能**：磁盘管理工具，用于管理磁盘分区、格式化磁盘、扩展或压缩卷等操作。
- **使用场景**：
  - 管理磁盘空间分配。
  - 修复磁盘错误。
  - 创建和管理虚拟硬盘。
- **命令**：
  ```plaintext
  diskmgmt.msc
  ```

#### 8. **`perfmon.msc`**
- **功能**：性能监视器，用于监控系统性能指标，如 CPU 使用率、内存使用量、磁盘 I/O 等。
- **使用场景**：
  - 分析系统性能瓶颈。
  - 监控系统资源使用情况。
  - 创建性能报告。
- **命令**：
  ```plaintext
  perfmon.msc
  ```

#### 9. **`secpol.msc`**
- **功能**：本地组策略编辑器，用于管理本地安全策略，如账户策略、本地策略等。
- **使用场景**：
  - 配置用户账户策略。
  - 管理本地安全设置。
  - 加强系统安全性。
- **命令**：
  ```plaintext
  secpol.msc
  ```

#### 10. **`taskschd.msc`**
- **功能**：任务计划程序，用于创建、管理和删除计划任务。
- **使用场景**：
  - 自动执行程序或脚本。
  - 定期备份文件或清理系统。
  - 管理系统维护任务。
- **命令**：
  ```plaintext
  taskschd.msc
  ```

#### 11. **`compmgmt.msc`**
- **功能**：计算机管理工具，是一个综合性的管理工具，包括服务、设备管理器、事件查看器等多个功能模块。
- **使用场景**：
  - 集中管理多个系统组件。
  - 快速访问常用的管理工具。
- **命令**：
  ```plaintext
  compmgmt.msc
  ```

#### 12. **`lusrmgr.msc`**
- **功能**：本地用户和组管理工具，用于管理本地用户账户和组。
- **使用场景**：
  - 管理用户权限。
  - 创建和管理用户组。
  - 配置用户登录策略。
- **命令**：
  ```plaintext
  lusrmgr.msc

#### 13. **`dcomcnfg.msc`**
- **功能**：用于配置分布式组件对象模型（DCOM）的安全性和默认属性。
- **使用场景**：
  - 配置远程访问和组件交互。
  - 管理 DCOM 安全设置。
- **命令**：
  ```plaintext
  dcomcnfg.msc
  ```

### 常用网络配置与故障排除命令
#### 1. **`ipconfig`**
- **功能**：用于显示和修改网络配置信息。
- **常用选项**：
  - **`ipconfig`（无参数）**：
    - **功能**：显示当前网络适配器的简要配置信息，包括 IP 地址、子网掩码和默认网关。
    - **使用场景**：快速查看当前网络适配器的 IP 地址等基本信息。
    - **命令**：
      ```plaintext
      ipconfig
      ```
  - **`ipconfig /all`**：
    - **功能**：显示所有网络适配器的详细配置信息，包括 IP 地址、子网掩码、默认网关、DNS 服务器等。
    - **使用场景**：查看网络配置的详细信息。
    - **命令**：
      ```plaintext
      ipconfig /all
      ```
  - **`ipconfig /flushdns`**：
    - **功能**：清空 DNS 解析缓存，解决 DNS 解析问题。
    - **使用场景**：当无法访问某个网站，但其他设备可以正常访问时。
    - **命令**：
      ```plaintext
      ipconfig /flushdns
      ```
  - **`ipconfig /release`**：
    - **功能**：释放当前网络适配器的 DHCP 租约，释放当前分配的 IP 地址。
    - **使用场景**：需要重新获取一个不同的 IP 地址时。
    - **命令**：
      ```plaintext
      ipconfig /release
      ```
  - **`ipconfig /renew`**：
    - **功能**：重新从 DHCP 服务器获取 IP 地址。
    - **使用场景**：与 `ipconfig /release` 配合使用，重新获取 IP 地址。
    - **命令**：
      ```plaintext
      ipconfig /renew
      ```

以下是按照您提供的格式整理后的内容：

#### 2. **`ping`**
- **功能**：测试主机之间的网络连接是否正常，通过发送 ICMP 回显请求消息来检查目标主机是否可达。
- **常用选项**：
  - **`ping <IP地址或域名>`**：
    - **功能**：发送默认的 4 个 ICMP 回显请求。
    - **使用场景**：快速检查目标主机是否可达。
    - **命令**：
      ```plaintext
      ping <IP地址或域名>
      ```
  - **`ping -t <IP地址或域名>`**：
    - **功能**：持续发送 ICMP 回显请求，直到手动中断。
    - **使用场景**：持续监测目标主机的网络连接状态。
    - **命令**：
      ```plaintext
      ping -t <IP地址或域名>
      ```
  - **`ping -n <次数> <IP地址或域名>`**：
    - **功能**：指定发送 ICMP 回显请求的次数。
    - **使用场景**：自定义发送请求的次数，以满足特定的测试需求。
    - **命令**：
      ```plaintext
      ping -n <次数> <IP地址或域名>
      ```
- **使用场景**：检查网络连接是否正常，例如 `ping 8.8.8.8`（Google 的公共 DNS 服务器）。

#### 3. **`tracert`**
- **功能**：跟踪数据包从源主机到目标主机的路径，帮助了解数据包在网络中的传输路径。
- **使用方法**：
  - **`tracert <IP地址或域名>`**：跟踪到目标主机的路径。
- **使用场景**：当遇到网络连接问题时，查看数据包是否在某个节点上丢失或延迟过高。
- **命令**：
  ```plaintext
  tracert <IP地址或域名>
  ```

#### 4. **`netstat`**
- **功能**：显示网络连接、路由表和网络接口统计信息。
- **常用选项**：
  - **`netstat`（无参数）**：
    - **功能**：显示当前的 TCP 连接状态，包括本地地址、外部地址和连接状态。
    - **使用场景**：快速查看当前的 TCP 连接状态。
    - **命令**：
      ```plaintext
      netstat
      ```
  - **`netstat -a`**：
    - **功能**：显示所有活动的 TCP 连接和监听端口。
    - **使用场景**：查看所有网络连接和监听端口。
    - **命令**：
      ```plaintext
      netstat -a
      ```
  - **`netstat -n`**：
    - **功能**：以数字形式显示地址和端口号，不解析主机名。
    - **使用场景**：快速查看网络连接，避免域名解析的延迟。
    - **命令**：
      ```plaintext
      netstat -n
      ```
  - **`netstat -o`**：
    - **功能**：显示每个连接的进程 ID。
    - **使用场景**：确定哪个进程正在使用特定的网络连接。
    - **命令**：
      ```plaintext
      netstat -o
      ```
  - **`netstat -r`**：
    - **功能**：显示路由表信息。
    - **使用场景**：查看系统的路由表配置。
    - **命令**：
      ```plaintext
      netstat -r
      ```
      
#### 5. **`nslookup`**
- **功能**：查询域名系统的（DNS）信息，将域名解析为 IP 地址，或反向解析 IP 地址为域名。
- **常用选项**：
  - **`nslookup <域名>`**：
    - **功能**：查询域名的 IP 地址。
    - **使用场景**：检查域名是否能正确解析为 IP 地址。
    - **命令**：
      ```plaintext
      nslookup <域名>
      ```
  - **`nslookup <IP地址>`**：
    - **功能**：查询 IP 地址的域名。
    - **使用场景**：检查 IP 地址是否能正确反向解析为域名。
    - **命令**：
      ```plaintext
      nslookup <IP地址>
      ```
- **使用场景**：检查域名解析是否正确。

#### 6. **`arp`**
- **功能**：显示和修改地址解析协议（ARP）表，存储 IP 地址和物理 MAC 地址的映射关系。
- **常用选项**：
  - **`arp -a`**：
    - **功能**：显示 ARP 表中的所有条目。
    - **使用场景**：查看当前网络中所有设备的 IP 地址与 MAC 地址的映射关系。
    - **命令**：
      ```plaintext
      arp -a
      ```
  - **`arp -d <IP地址>`**：
    - **功能**：删除指定 IP 地址的 ARP 条目。
    - **使用场景**：清除异常或不再使用的 ARP 条目，例如在怀疑 ARP 欺骗攻击时。
    - **命令**：
      ```plaintext
      arp -d <IP地址>
      ```
- **使用场景**：怀疑网络中有 ARP 欺骗攻击时，查看异常的 MAC 地址。

以下是按照您提供的格式整理后的内容：

#### 7. **`route`**
- **功能**：查看和修改路由表，决定数据包在网络中的传输路径。
- **常用选项**：
  - **`route print`**：
    - **功能**：显示当前的路由表。
    - **使用场景**：查看系统当前的网络路由配置。
    - **命令**：
      ```plaintext
      route print
      ```
  - **`route add <目标网络> mask <子网掩码> <网关>`**：
    - **功能**：添加新的路由条目。
    - **使用场景**：手动添加静态路由，指定数据包传输路径。
    - **命令**：
      ```plaintext
      route add <目标网络> mask <子网掩码> <网关>
      ```
  - **`route delete <目标网络>`**：
    - **功能**：删除指定的路由条目。
    - **使用场景**：移除不再需要的路由条目。
    - **命令**：
      ```plaintext
      route delete <目标网络>
      ```
- **使用场景**：手动配置网络路径，例如添加静态路由。

#### 8. **`netsh`**
- **功能**：网络外壳工具，用于配置和监视 Windows 网络。它是一个功能强大的命令行工具，可以执行各种网络相关操作。
- **常用选项**：
  - **`netsh int ip reset`**：
    - **功能**：重置 TCP/IP 协议栈。
    - **使用场景**：当 TCP/IP 协议栈出现故障或配置错误时，通过重置来恢复默认设置。
    - **命令**：
      ```plaintext
      netsh int ip reset
      ```
  - **`netsh winsock reset`**：
    - **功能**：重置 Winsock 目录。
    - **使用场景**：当 Winsock 目录出现故障或被恶意软件篡改时，通过重置来恢复默认设置。
    - **命令**：
      ```plaintext
      netsh winsock reset
      ```
- **使用场景**：当你遇到网络连接问题，且常规方法无法解决时，可以尝试重置网络配置。

#### 9. **添加、删除和修改 IP 地址的管理配置命令**
- **添加 IP 地址**：
  - **命令格式**：
    ```plaintext
    netsh interface ip add address "适配器名称" source=static address=<新IP地址> subnetmask=<子网掩码> gateway=<默认网关>
    ```
  - **示例**：为名为“以太网”的适配器添加 IP 地址为 `192.168.1.100`，子网掩码为 `255.255.255.0`，默认网关为 `192.168.1.1`：
    ```plaintext
    netsh interface ip add address "以太网" source=static address=192.168.1.100 subnetmask=255.255.255.0 gateway=192.168.1.1
    ```
- **删除 IP 地址**：
  - **命令格式**：
    ```plaintext
    netsh interface ip delete address "适配器名称" source=static address=<旧IP地址>
    ```
  - **示例**：删除名为“以太网”的适配器的 IP 地址为 `192.168.1.100`：
    ```plaintext
    netsh interface ip delete address "以太网" source=static address=192.168.1.100
    ```
- **修改 IP 地址**：
  - **命令格式**：
    ```plaintext
    netsh interface ip set address "适配器名称" source=static address=<新IP地址> subnetmask=<子网掩码> gateway=<默认网关>
    ```
  - **示例**：将名为“以太网”的适配器的 IP 地址从 `192.168.1.100` 修改为 `192.168.1.200`，子网掩码保持为 `255.255.255.0`，默认网关保持为 `192.168.1.1`：
    ```plaintext
    netsh interface ip set address "以太网" source=static address=192.168.1.200 subnetmask=255.255.255.0 gateway=192.168.1.1
    ```
- **使用 DHCP 自动获取 IP 地址**：
  - **命令格式**：
    ```plaintext
    netsh interface ip set address "适配器名称" source=dhcp
    ```
  - **示例**：将名为“以太网”的适配器设置为通过 DHCP 自动获取 IP 地址：
    ```plaintext
    netsh interface ip set address "以太网" source=dhcp
    ```
- **配置 DNS 服务器**：
  - **设置静态 DNS 服务器**：
    - **命令格式**：
      ```plaintext
      netsh interface ip set dns "适配器名称" static <DNS服务器地址> primary
      ```
    - **示例**：为名为“以太网”的适配器设置首选 DNS 服务器为 `8.8.8.8`：
      ```plaintext
      netsh interface ip set dns "以太网" static 8.8.8.8 primary
      ```
  - **添加备用 DNS 服务器**：
    - **命令格式**：
      ```plaintext
      netsh interface ip add dns "适配器名称" <备用DNS服务器地址> index=2
      ```
    - **示例**：为名为“以太网”的适配器添加备用 DNS 服务器为 `8.8.4.4`：
      ```plaintext
      netsh interface ip add dns "以太网" 8.8.4.4 index=2
      ```
  - **通过 DHCP 自动获取 DNS 服务器**：
    - **命令格式**：
      ```plaintext
      netsh interface ip set dns "适配器名称" source=dhcp
      ```
    - **示例**：将名为“以太网”的适配器设置为通过 DHCP 自动获取 DNS 服务器：
      ```plaintext
      netsh interface ip set dns "以太网" source=dhcp
      ```
- **使用场景**：
  - 手动配置网络适配器的 IP 地址、子网掩码、默认网关和 DNS 服务器。
  - 将网络适配器设置为通过 DHCP 自动获取 IP 地址和 DNS 服务器。
  - 修改现有 IP 地址配置或 DNS 服务器配置。
  - 移除不再需要的静态 IP 地址或 DNS 服务器配置。
