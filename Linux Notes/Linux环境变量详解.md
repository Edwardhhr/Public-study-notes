# Linux环境变量详解

### 1.概述
**环境变量一般指的是在操作系统中用于指定操作系统运行环境的一些参数**  
在链接C/C++程序的代码时，会用到动静态库，但是动静态库我们并没有显示的去指定过让系统去那个路径下寻找它，但是每次都可以链接成功，这是因为有了环境变量的帮助  
环境变量还会有一些特殊的用途，比如可以用作身份验证  

### 2.环境变量的分类 
- 按照**生命周期**来分，Linux环境变量可以分为两类：
    - **永久的**：需要用户修改相关的配置文件，变量永久生效
    - **临时的**：用户利用export命令，在当前终端下声明环境变量，关闭Shell终端失效
- 按照**作用域**来分，Linux环境变量可以分为：
    - **系统环境变量**：系统环境变量对该系统中所有用户都有效，编辑`/etc/profile`、`/etc/environment`文件
    - **用户环境变量**：顾名思义，这种类型的环境变量只对特定的用户有效，编辑`/.bashrc`、`/.bash_profile`或`~/.profile`文件（根据您使用的Shell）

### 3.常见的环境变量
- `PATH`：决定了 shell 将到哪些目录中寻找命令或程序
- `HOME`：当前用户主目录(就是用户登录linux系统中时，默认的目录
- `USER`：当前用户的用户名。
- `HISTSIZE`：历史记录数
- `LOGNAME`：当前用户的登录名
- `HOSTNAME`：指主机的名称
- `SHELL`：当前用户 Shell 类型，它的通常值是/bin/bash
- `LANGUGE`：语言相关的环境变量，多语言可以修改此环境变量
- `MAIL`：当前用户的邮件存放目录
- `PS1`：基本提示符，对于 root 用户是 #，对于普通用户是 $

***Linux 系统中环境变量的名称一般都是大写的，这是一种约定俗成的规范***  

### 4.查看环境变量
#### 4.1 Shell变量
`echo`的作用是用于`字符串的输出`,运行shell时，会同时存在三种变量：  
- **局部变量**: 局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量
- **环境变量**: 所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量
- **shell变量**: shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行

**Shell 变量命名规则**:  
1. **变量名的组成**：
- 变量名只能包含英文字母（a-z 和 A-Z）、数字（0-9）和下划线（_）
- **首个字符不能是数字**，必须是字母或下划线
2. **变量名的格式**：
- 变量名中**不能包含空格**。如果需要分隔单词，可以使用下划线（_），例如 user_name
- 变量名中**不能包含标点符号**（如 !、@、#、$ 等）
3. **保留关键字**：
- 变量名不能与 Shell 的保留关键字相同。可以使用 `help` 命令查看 Bash 的保留关键字。
常见的保留关键字包括：`if`、`then`、`else`、`elif`、`fi`、`for`、`while`、`do`、`done`、`case`、`esac` 等
4. **大小写敏感**：
- Shell 是大小写敏感的，因此 Variable 和 variable 是两个不同的变量
5. **定义变量时的注意事项**：
- 定义变量时，**变量名和等号之间不能有空格**,例如：
```bash
name="edward"  # 正确
name = "edward"  # 错误，会导致语法错误
```
变量值可以包含空格，但必须用双引号或单引号括起来,例如：
```bash
greeting="Hello, world!"  # 正确
```

**总结与强调**
- **变量名和等号之间不能有空格**
- **变量值如果包含空格，需要用引号括起来**
- **大小写敏感**，Variable 和 variable 是不同的变量

#### 4.2 查看环境变量
查看当前**用户**全部的环境变量：
```bash
env
```
筛选包含的环境变量：
```bash
env | grep 环境变量名
```
示例：
```bash
env | grep PATH
```
显示当前**系统**定义的所有环境变量：
```bash
export
```
查看指定环境变量的值：
```bash
printenv 环境变量名
```
或
```bash
echo $环境变量名
```
示例：
```
echo $PATH
```

会输出这样一串字符：`/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin`  
他们以 : 作为分隔符,将其分隔成一些子路径，当写入命令时，会自动一个子路径一个子路径的寻找命令自己的源文件，所以就不需要像我们自己写的文件那样，需要主动加上路径(`./project`)，才能被系统所识别运行  


### 5.添加环境变量
环境变量也是变量，跟shell变量的操作一样，`不过PATH=(需要添加的环境变量)这么写可就错了，这样会覆盖掉原来的环境变量`，所以得：`PATH=$PATH:(需要添加的环境变量)`  
需要注意的是，上面那样添加的环境变量在子进程及其后代进程不会产生影响，且`只对本次登录有效`，具有`临时性`。要是`想对子进程及其后代进程也有效，需要引入export`  
需要这样写：`export PATH=$PATH:(需要添加的进程)`  
#### 添加系统级环境变量
**需root权限、针对所有用户、永久生效**  
编辑配置文件：
```bash
vim /etc/profile
```
配置示例：
```bash
export PATH="/opt/STM/STLinux-2.3/devkit/sh4/bin:$PATH"
```
使配置生效：
```bash
source /etc/profile
```
***注：一般只有root用户才有编辑权限***  

#### 添加用户级环境变量
在用户的`家目录（~）下`，当使用 Bash shell 时，系统会自动加载以下文件（如果存在）：
- `.bash_profile`：这是在登录时加载的主要文件。通常用于设置用户的个人环境变量和启动脚本  
- `.bash_login`：如果 `.bash_profile` 不存在，则会尝试加载此文件  
- `.profile`：如果 `.bash_profile` 和 `.bash_login` 都不存在，则会尝试加载此文件。这是一个通用的配置文件，适用于多种类型的 shell  
- `.bashrc`：这是在每次打开新的终端窗口时加载的文件。它包含了用户定义的别名、函数、自定义环境变量等  
通常情况下，用户可以在`.bash_profile`、`.bash_login` 或 `.profile`    
文件中设置一些全局的环境变量和启动脚本，而在.bashrc 文件中设置一些特定于 Bash 的配置和个人设置  
请注意，这是默认的行为，具体的加载顺序可能会受到系统配置的影响
```bash
cd ~
```
```bash
vim ./bash_profile
```
```bash
export PATH=$PATH:(需要添加的进程)
```
即可永久性的添加环境变量  
修改文件后要想马上生效还要运行：
```bash
source ./bash_profile
```

### 6.删除环境变量
删除永久性的环境变量需要`进入到配置文件中删除相应的命令`  

删除临时性的环境变量需要使用到`unset （环境变量名称）`命令，如`unset PATH`  

此时会清除所有的命令，若是只想清除部分路径，可以使用添加环境变量的方法进行修改
比如:`PATH=(需要保留的路径):(需要删除的路径)`可以：`PATH=$(需要保留的路径)`

修改文件后要想马上生效还要运行：
```bash
source ./bash_profile
```