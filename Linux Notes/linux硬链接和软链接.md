# Linux软链接与硬链接学习笔记

## 1. 链接的作用

在Linux系统中，软链接和硬链接是两种非常有用的文件系统特性，它们允许我们以不同的方式创建对文件或目录的引用。

### 1.1 解决文件共享

- **软链接和硬链接**的主要目的是为了解决文件的共享使用问题。
- 它们提供了隐藏文件路径、增加权限安全及节省存储空间的好处。

### 1.2 Inode是什么？
在Linux文件系统中，Inode（索引节点） 是一个数据结构，用于存储文件的元数据，但不包括文件名和文件内容。每个文件或目录都有一个唯一的Inode，它包含了以下信息：

- 文件的权限
- 文件的所有者和所属组
- 文件的大小
- 文件的创建、修改和访问时间
- 文件数据块的地址（即文件内容的存储位置）
- Inode是文件系统中识别文件的关键，文件名和Inode之间的关系是多对一的，即多个文件名可以指向同一个Inode，这就是硬链接的工作原理。


## 2. 硬链接

### 2.1 硬链接特性

- **硬链接**是通过索引节点（Inode）来实现的。
- 硬链接可以看作是文件索引节点的指针，系统不会为它重新分配Inode。
- 每添加一个硬链接，文件的链接数就会增加1。

#### 2.1.1 硬链接的删除

- 删除硬链接时，只是从目录中删除了该链接，文件的链接数会减少1。
- 只有当文件的链接数减少到0时，文件才会被真正删除。

#### 2.1.2 实例演示

```bash
# 创建文件夹和文件
mkdir /hardlink
cd /hardlink
touch aa.txt

# 查看文件的链接数
ls -il

# 创建硬链接
ln aa.txt aa.link

# 查看链接数变化
ls -il

# 向原文件写入内容
echo "123" > aa.txt

# 查看硬链接内容
cat aa.link

# 删除原文件
rm -f aa.txt

# 查看硬链接内容
cat aa.link
```

### 2.2 硬链接的限制

- **无法跨分区**：硬链接不能跨越不同的文件系统或分区。
- **无法为目录创建硬链接**：为了防止文件系统的死循环，不能为目录创建硬链接。


## 3. 软链接

### 3.1 软链接特性

- **软链接**类似于Windows中的快捷方式，它是一个指向原文件路径的指针。
- 软链接有自己的Inode，与原文件的Inode不同。
- 软链接可以跨分区、跨设备创建。

#### 3.1.1 实例演示

```bash
# 创建文件夹和文件
mkdir /softlink
cd /softlink
touch aa.txt

# 创建软链接
ln -s aa.txt soft.link

# 查看文件和链接的详细信息
ls -il

# 向原文件写入内容
echo "hahaha" > aa.txt

# 查看软链接大小
ls -il
```

### 3.2 软链接的使用注意事项

- **相对路径**：软链接的相对路径是从软链接的位置开始计算的。
- **依赖性**：如果原文件被删除，软链接将失效。


## 4. 软链接与硬链接的区别

| 特性       | 硬链接          | 软链接          |
|------------|-----------------|-----------------|
| 本质       | 同一个Inode     | 不同的Inode     |
| 跨分区     | 不能           | 可以            |
| 目录       | 不能创建目录链接 | 可以创建目录链接 |
| 相互关系   | 相互独立       | 依赖原文件      |
| 链接数     | 影响链接数      | 不影响链接数    |
| 相对路径   | 原文件路径相对于当前路径 | 相对于软链接路径 |
| 文件类型   | 与原文件一致    | 显示为symbolic link |
| 创建方式   | `ln [原文件] [硬链接]` | `ln -s [原文件] [软链接]` |


## 5. 总结

- **硬链接**提供了一种文件的多重引用方式，但有其限制，如不能跨分区和不能为目录创建。
- **软链接**则提供了更多的灵活性，可以跨分区和为目录创建，但依赖于原文件的存在。
